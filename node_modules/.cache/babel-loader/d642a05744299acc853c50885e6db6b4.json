{"ast":null,"code":"import axios from \"axios\";\n\nvar generateRandomString = function (length) {\n  var text = '';\n  var possible = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n\n  for (var i = 0; i < length; i++) {\n    text += possible.charAt(Math.floor(Math.random() * possible.length));\n  }\n\n  return text;\n};\n\nconst CLIENT_ID = \"55b9c926505a44b9b685faaec5b28633\";\nconst REDIRECT_URI = \"http://localhost:8081/callback\";\nconst AUTH_ENDPOINT = \"https://accounts.spotify.com/authorize\";\nconst RESPONSE_TYPE = \"code\";\nconst CLIENT_SECRET = '75a0d8b2918c4159a1cb68bea678d562';\nconst SCOPE = 'user-top-read';\n\nclass SpotifyService {\n  getAuth() {\n    const state = generateRandomString(16);\n    const {\n      data\n    } = axios.get(\"https://api.spotify.com/v1/search\", {\n      headers: {\n        Authorization: `Bearer ${token}`\n      },\n      params: {\n        q: searchKey,\n        type: \"artist\"\n      }\n    });\n    return http.get(\"/songdatas\");\n  }\n\n  getTopData(id) {\n    return http.get(`/songdatas/${id}`);\n  }\n\n  login(data) {\n    return http.post(\"/songdatas\", data);\n  }\n\n  updateToken() {\n    //app.get('/refresh_token', function (req, res) {\n    // requesting access token from refresh token \n    function getHashParams() {\n      var hashParams = {};\n      var e,\n          r = /([^&;=]+)=?([^&;]*)/g,\n          q = window.location.hash.substring(1);\n\n      while (e = r.exec(q)) {\n        hashParams[e[1]] = decodeURIComponent(e[2]);\n      }\n\n      return hashParams;\n    }\n\n    var params = getHashParams();\n    var access_token = params.access_token,\n        refresh_token = params.refresh_token,\n        error = params.error;\n    /*http.post(authOptions, function (error, response, body) {\r\n        if (!error && response.statusCode === 200) {\r\n            var access_token = body.access_token;\r\n            res.send({\r\n                'access_token': access_token\r\n            });\r\n        }\r\n    });*/\n\n    http.post('/refresh_token', {\n      data: {\n        'refresh_token': refresh_token\n      }\n    }).then(response => {\n      console.log(response); //dispatch({ type: FOUND_USER, data: response.data[0] })\n    }).catch(error => {\n      console.log(error); //dispatch({ type: ERROR_FINDING_USER })\n    }); //return response.access_token//http.put(`/songdatas/${id}`, data);\n  }\n\n}\n\nexport default new SpotifyService();","map":{"version":3,"names":["axios","generateRandomString","length","text","possible","i","charAt","Math","floor","random","CLIENT_ID","REDIRECT_URI","AUTH_ENDPOINT","RESPONSE_TYPE","CLIENT_SECRET","SCOPE","SpotifyService","getAuth","state","data","get","headers","Authorization","token","params","q","searchKey","type","http","getTopData","id","login","post","updateToken","getHashParams","hashParams","e","r","window","location","hash","substring","exec","decodeURIComponent","access_token","refresh_token","error","then","response","console","log","catch"],"sources":["B:/Otavio/Documents/IOT/FrontMaisTocadasUFMG/src/services/spotify.service.js"],"sourcesContent":["import axios from \"axios\";\r\n\r\nvar generateRandomString = function (length) {\r\n    var text = '';\r\n    var possible = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\r\n\r\n    for (var i = 0; i < length; i++) {\r\n        text += possible.charAt(Math.floor(Math.random() * possible.length));\r\n    }\r\n    return text;\r\n};\r\nconst CLIENT_ID = \"55b9c926505a44b9b685faaec5b28633\"\r\nconst REDIRECT_URI = \"http://localhost:8081/callback\"\r\nconst AUTH_ENDPOINT = \"https://accounts.spotify.com/authorize\"\r\nconst RESPONSE_TYPE = \"code\"\r\nconst CLIENT_SECRET = '75a0d8b2918c4159a1cb68bea678d562'\r\nconst SCOPE = 'user-top-read';\r\n\r\nclass SpotifyService {\r\n    getAuth() {\r\n        const state = generateRandomString(16);\r\n        const { data } = axios.get(\"https://api.spotify.com/v1/search\", {\r\n            headers: {\r\n                Authorization: `Bearer ${token}`\r\n            },\r\n            params: {\r\n                q: searchKey,\r\n                type: \"artist\"\r\n            }\r\n        })\r\n\r\n        return http.get(\"/songdatas\");\r\n    }\r\n    getTopData(id) {\r\n        return http.get(`/songdatas/${id}`);\r\n    }\r\n    login(data) {\r\n        return http.post(\"/songdatas\", data);\r\n    }\r\n    updateToken() { //app.get('/refresh_token', function (req, res) {\r\n        // requesting access token from refresh token \r\n        function getHashParams() {\r\n            var hashParams = {};\r\n            var e, r = /([^&;=]+)=?([^&;]*)/g,\r\n                q = window.location.hash.substring(1);\r\n            while (e = r.exec(q)) {\r\n                hashParams[e[1]] = decodeURIComponent(e[2]);\r\n            }\r\n            return hashParams;\r\n        }\r\n        var params = getHashParams();\r\n        var access_token = params.access_token,\r\n            refresh_token = params.refresh_token,\r\n            error = params.error;\r\n\r\n        /*http.post(authOptions, function (error, response, body) {\r\n            if (!error && response.statusCode === 200) {\r\n                var access_token = body.access_token;\r\n                res.send({\r\n                    'access_token': access_token\r\n                });\r\n            }\r\n        });*/\r\n\r\n        http.post('/refresh_token', {\r\n            data: {\r\n                'refresh_token': refresh_token\r\n            }\r\n        })\r\n            .then((response) => {\r\n                console.log(response) //dispatch({ type: FOUND_USER, data: response.data[0] })\r\n            })\r\n            .catch((error) => {\r\n                console.log(error)//dispatch({ type: ERROR_FINDING_USER })\r\n            })\r\n\r\n        //return response.access_token//http.put(`/songdatas/${id}`, data);\r\n    }\r\n}\r\nexport default new SpotifyService();"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;;AAEA,IAAIC,oBAAoB,GAAG,UAAUC,MAAV,EAAkB;EACzC,IAAIC,IAAI,GAAG,EAAX;EACA,IAAIC,QAAQ,GAAG,gEAAf;;EAEA,KAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,MAApB,EAA4BG,CAAC,EAA7B,EAAiC;IAC7BF,IAAI,IAAIC,QAAQ,CAACE,MAAT,CAAgBC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgBL,QAAQ,CAACF,MAApC,CAAhB,CAAR;EACH;;EACD,OAAOC,IAAP;AACH,CARD;;AASA,MAAMO,SAAS,GAAG,kCAAlB;AACA,MAAMC,YAAY,GAAG,gCAArB;AACA,MAAMC,aAAa,GAAG,wCAAtB;AACA,MAAMC,aAAa,GAAG,MAAtB;AACA,MAAMC,aAAa,GAAG,kCAAtB;AACA,MAAMC,KAAK,GAAG,eAAd;;AAEA,MAAMC,cAAN,CAAqB;EACjBC,OAAO,GAAG;IACN,MAAMC,KAAK,GAAGjB,oBAAoB,CAAC,EAAD,CAAlC;IACA,MAAM;MAAEkB;IAAF,IAAWnB,KAAK,CAACoB,GAAN,CAAU,mCAAV,EAA+C;MAC5DC,OAAO,EAAE;QACLC,aAAa,EAAG,UAASC,KAAM;MAD1B,CADmD;MAI5DC,MAAM,EAAE;QACJC,CAAC,EAAEC,SADC;QAEJC,IAAI,EAAE;MAFF;IAJoD,CAA/C,CAAjB;IAUA,OAAOC,IAAI,CAACR,GAAL,CAAS,YAAT,CAAP;EACH;;EACDS,UAAU,CAACC,EAAD,EAAK;IACX,OAAOF,IAAI,CAACR,GAAL,CAAU,cAAaU,EAAG,EAA1B,CAAP;EACH;;EACDC,KAAK,CAACZ,IAAD,EAAO;IACR,OAAOS,IAAI,CAACI,IAAL,CAAU,YAAV,EAAwBb,IAAxB,CAAP;EACH;;EACDc,WAAW,GAAG;IAAE;IACZ;IACA,SAASC,aAAT,GAAyB;MACrB,IAAIC,UAAU,GAAG,EAAjB;MACA,IAAIC,CAAJ;MAAA,IAAOC,CAAC,GAAG,sBAAX;MAAA,IACIZ,CAAC,GAAGa,MAAM,CAACC,QAAP,CAAgBC,IAAhB,CAAqBC,SAArB,CAA+B,CAA/B,CADR;;MAEA,OAAOL,CAAC,GAAGC,CAAC,CAACK,IAAF,CAAOjB,CAAP,CAAX,EAAsB;QAClBU,UAAU,CAACC,CAAC,CAAC,CAAD,CAAF,CAAV,GAAmBO,kBAAkB,CAACP,CAAC,CAAC,CAAD,CAAF,CAArC;MACH;;MACD,OAAOD,UAAP;IACH;;IACD,IAAIX,MAAM,GAAGU,aAAa,EAA1B;IACA,IAAIU,YAAY,GAAGpB,MAAM,CAACoB,YAA1B;IAAA,IACIC,aAAa,GAAGrB,MAAM,CAACqB,aAD3B;IAAA,IAEIC,KAAK,GAAGtB,MAAM,CAACsB,KAFnB;IAIA;AACR;AACA;AACA;AACA;AACA;AACA;AACA;;IAEQlB,IAAI,CAACI,IAAL,CAAU,gBAAV,EAA4B;MACxBb,IAAI,EAAE;QACF,iBAAiB0B;MADf;IADkB,CAA5B,EAKKE,IALL,CAKWC,QAAD,IAAc;MAChBC,OAAO,CAACC,GAAR,CAAYF,QAAZ,EADgB,CACM;IACzB,CAPL,EAQKG,KARL,CAQYL,KAAD,IAAW;MACdG,OAAO,CAACC,GAAR,CAAYJ,KAAZ,EADc,CACI;IACrB,CAVL,EAzBU,CAqCV;EACH;;AA3DgB;;AA6DrB,eAAe,IAAI9B,cAAJ,EAAf"},"metadata":{},"sourceType":"module"}